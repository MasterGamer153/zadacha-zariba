<div class="chat-page">

  <!-- Top bar -->
  <div class="chat-header">
    <h2>Chat</h2>
    <button (click)="logout()">Log out</button>
  </div>

  <div class="chat-body">

    <!-- Conversations -->
    <div class="conversations">
      <div
        class="conversation"
        *ngFor="let convo of conversations"
        (click)="selectConversation(convo.id)"
        [class.active]="convo.id === selectedConversationId"
      >
        <div class="name">{{ convo.name }}</div>
      </div>
    </div>

    <!-- Messages Panel -->
    <div class="messages-panel">

      <div class="messages">

        <ng-container *ngIf="selectedConversationId; else noConversation">

          <div
            class="message"
            *ngFor="let msg of selectedMessages"
            [class.me]="msg.sender_id === auth.getUser()?.userId"
            [class.other]="msg.sender_id !== auth.getUser()?.userId"
          >

            <div class="content">
              {{ msg.content }}
            </div>

            <div class="created-at">
              {{ msg.created_at | date:'shortTime' }}
            </div>

          </div>

        </ng-container>

        <ng-template #noConversation>
          <p>Select a conversation to start chatting</p>
        </ng-template>

      </div>

      <!-- Input Area -->
      <div class="input-area">
        <input
          type="text"
          placeholder="Type a message..."
          [(ngModel)]="newMessageText"
          (keyup.enter)="sendMessage()"
        />
        <button (click)="sendMessage()">Send</button>
      </div>

    </div>

  </div>
</div>
